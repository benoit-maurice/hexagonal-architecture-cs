# hexagonal-architecture-cs

Inspired by https://github.com/emilybache/KataTrainReservation

## Objective : Train Reservation Service

Implement a web service that allow train seats reservation.

This service must have a REST api with one route :

```http
   POST /tickets
```

Taking a json as payload as follow :

```json
{
	"train_id": "OrientExpress001",
	"seat_count": 2
}
```

and should return another json :

```json
{
	"train_id": "OrientExpress001",
	"booking_reference": "REF_1234",
	"seats": ["1A","2A"],
}
```

All train data must be retrieved from the following service : https://train-service-apim.developer.azure-api.net/apis

Booking reference should be generated by the TrainReservation service.

### Feature 1 : Empty train

Prefere booking consecutive seats from the same coach.

```cucumber
Given an empty Train with id "OrientExpress001"
When a user reserves 2 tickets
Then he should get a valid reservation with seats "1A,2A"
And the reference should be "REF_1234"
```

### Feature 2 : Full train

```cucumber
Given a fully booked Train with id "OrientExpress001"
When a user reserves 2 tickets
Then he should get an error "Train is full"
```

### Feature 3 : Train booking threshold reached

```cucumber
Given a Train booked at 70% with id "OrientExpress001"
When a user reserves 2 tickets
Then he should get an error "Train is full"
```

### Feature 4 : Coach booking threshold reached

When a coach reaches the 70% threshold then book in another coach.

```cucumber
Given a Train with id "OrientExpress001" 
And the following coaches
 | Coach | Seat Count | Booked Seat Count |
 | A     |         10 |                 6 |
 | B     |         10 |                 0 |
When a user reserves 2 tickets
Then he should get a valid reservation with seats "7A,1B"
And the reference should be "REF_1234"
```
